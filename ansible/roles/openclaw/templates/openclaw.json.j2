{
  "agents": {
    "defaults": {
      "model": {
{% if llm_provider == "anthropic" %}
        "primary": "{{ llm_model or 'anthropic/claude-opus-4-6' }}"
{% elif llm_provider == "openai" %}
        "primary": "{{ llm_model or 'openai/gpt-4o' }}"
{% elif llm_provider == "do_ai" %}
        "primary": "{{ llm_model or 'do-ai/llama-3.3-70b-instruct' }}"
{% elif llm_provider == "gradient" %}
        "primary": "{{ llm_model or 'gradient/llama-3.1-8b' }}"
{% else %}
        "primary": "{{ llm_model }}"
{% endif %}
      }
    }
  },
{% if llm_provider == "do_ai" %}
  "models": {
    "mode": "merge",
    "providers": {
      "do-ai": {
        "baseUrl": "https://inference.do-ai.run/v1",
        "apiKey": "${DO_AI_API_KEY}",
        "api": "openai-completions",
        "models": [
          { "id": "llama-3.3-70b-instruct", "name": "Llama 3.3 70B", "contextWindow": 128000, "maxTokens": 8192 },
          { "id": "deepseek-r1-distill-llama-70b", "name": "DeepSeek R1 70B", "reasoning": true, "contextWindow": 128000, "maxTokens": 8192 }
        ]
      }
    }
  },
{% endif %}
  "gateway": {
    "port": 18789,
    "mode": "local",
{% if access_method == "https" %}
    "trustedProxies": ["172.17.0.0/16"],
{% endif %}
    "auth": {
      "mode": "token",
      "token": "{{ _gateway_token }}"
    },
    "controlUi": {
      "enabled": {{ enable_control_ui | default(true) | lower }},
      "basePath": "/openclaw"
    }
  },
{% set _extra_channels = openclaw_channels | default([]) | reject('equalto', 'telegram') | list %}
{% set _has_telegram = telegram_bot_token != "" or 'telegram' in openclaw_channels | default([]) %}
{% set _channels = (['telegram'] if _has_telegram else []) + _extra_channels %}
{% if _channels | length > 0 %}
  "channels": {
{% for channel in _channels %}
{% if channel == 'telegram' and telegram_bot_token != "" %}
    "{{ channel }}": {
      "enabled": true,
      "botToken": "{{ telegram_bot_token }}",
      "dmPolicy": "{{ telegram_dm_policy }}"
    }{{ ',' if not loop.last else '' }}
{% else %}
    "{{ channel }}": {
      "enabled": true,
      "dmPolicy": "pairing"
    }{{ ',' if not loop.last else '' }}
{% endif %}
{% endfor %}
  },
{% endif %}
  "commands": {
    "native": "auto",
    "nativeSkills": "auto"
  }
}
